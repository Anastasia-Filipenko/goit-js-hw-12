{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load_more_button');\n\nfunction showLoader() {\n  loader.style.display = 'flex';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtn.style.display = 'flex';\n}\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.style.display = 'none';\n}\n\nhideLoadMoreBtn();\nhideLoader();\n\nconst getGalleryCardHeight = () => {\n  const galleryCard = document.querySelector('.gallery_list');\n  const cardHeight = galleryCard.getBoundingClientRect().height;\n  return cardHeight;\n};\n\nconst smoothScroll = () => {\n  const cardHeight = getGalleryCardHeight();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};\n\nconst getImages = async params => {\n  try {\n    const response = await axios.get(\n      `https://pixabay.com/api/?key=32445891-4e5aca6c6794ec22921e6fc5b`,\n      { params }\n    );\n    return response.data;\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nconst createRequest = q => {\n  let page = 1;\n  const per_page = 40;\n  let isLastPage = false;\n\n  return async () => {\n    try {\n      if (isLastPage) return;\n\n      const { hits, totalHits } = await getImages({\n        q,\n        page,\n        per_page,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n      });\n      showLoadMoreBtn();\n      if (page >= totalHits / per_page) {\n        hideLoadMoreBtn();\n        isLastPage = true;\n        iziToast.warning({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n\n      page += 1;\n      return hits;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};\n\nconst galleryLightbox = new SimpleLightbox('.gallery_list a', {\n  captions: true,\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nfunction render(images) {\n  const markup = images.reduce(\n    (\n      html,\n      { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n    ) =>\n      html +\n      `\n         <li class='gallery_list'>\n          <a href=\"${largeImageURL}\"><img class='gallery_img'src=\"${webformatURL}\" alt=\"${tags}\" /></a>\n          <p class='gallery_info'>Likes <span>${likes}</span></p>\n          <p class='gallery_info'>Views <span>${views}</span></p>\n          <p class='gallery_info'>Comments <span>${comments}</span></p>\n          <p class='gallery_info'>Downloads <span>${downloads}</span></p>\n        </li>`,\n    ''\n  );\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  galleryLightbox.refresh();\n}\n\nlet fetch = null;\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  if (fetch != null) loadMoreBtn.removeEventListener('click', fetch);\n\n  const inputValue = form.querySelector('.form_input').value;\n\n  gallery.innerHTML = '';\n\n  const fetchImage = createRequest(inputValue);\n\n  let isFirstLoad = true;\n\n  fetch = async () => {\n    showLoader();\n    const hits = await fetchImage();\n    render(hits);\n    hideLoader();\n\n    if (!isFirstLoad) {\n      smoothScroll();\n    }\n\n    isFirstLoad = false;\n  };\n\n  await fetch();\n\n  loadMoreBtn.addEventListener('click', fetch);\n});\n"],"names":["form","gallery","loader","loadMoreBtn","showLoader","hideLoader","showLoadMoreBtn","hideLoadMoreBtn","getGalleryCardHeight","smoothScroll","cardHeight","getImages","params","axios","error","createRequest","q","page","per_page","isLastPage","hits","totalHits","iziToast","galleryLightbox","SimpleLightbox","render","images","markup","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","fetch","e","inputValue","fetchImage","isFirstLoad"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,mBAAmB,EAE9D,SAASC,GAAa,CACpBF,EAAO,MAAM,QAAU,MACzB,CAEA,SAASG,GAAa,CACpBH,EAAO,MAAM,QAAU,MACzB,CAEA,SAASI,GAAkB,CACzBH,EAAY,MAAM,QAAU,MAC9B,CACA,SAASI,GAAkB,CACzBJ,EAAY,MAAM,QAAU,MAC9B,CAEAI,IACAF,IAEA,MAAMG,EAAuB,IACP,SAAS,cAAc,eAAe,EAC3B,sBAAqB,EAAG,OAInDC,EAAe,IAAM,CACzB,MAAMC,EAAaF,IACnB,OAAO,SAAS,CACd,IAAKE,EAAa,EAClB,SAAU,QACd,CAAG,CACH,EAEMC,EAAY,MAAMC,GAAU,CAChC,GAAI,CAKF,OAJiB,MAAMC,EAAM,IAC3B,kEACA,CAAE,OAAAD,CAAQ,CAChB,GACoB,IACjB,OAAQE,EAAP,CACA,QAAQ,IAAIA,CAAK,CAClB,CACH,EAEMC,EAAgBC,GAAK,CACzB,IAAIC,EAAO,EACX,MAAMC,EAAW,GACjB,IAAIC,EAAa,GAEjB,MAAO,UAAY,CACjB,GAAI,CACF,GAAIA,EAAY,OAEhB,KAAM,CAAE,KAAAC,EAAM,UAAAC,CAAW,EAAG,MAAMV,EAAU,CAC1C,EAAAK,EACA,KAAAC,EACA,SAAAC,EACA,WAAY,QACZ,YAAa,aACb,WAAY,EACpB,CAAO,EACD,OAAAZ,IACIW,GAAQI,EAAYH,IACtBX,IACAY,EAAa,GACbG,EAAS,QAAQ,CACf,QAAS,6DACT,SAAU,UACpB,CAAS,GAGHL,GAAQ,EACDG,CACR,OAAQN,EAAP,CACA,QAAQ,IAAIA,CAAK,CAClB,CACL,CACA,EAEMS,EAAkB,IAAIC,EAAe,kBAAmB,CAC5D,SAAU,GACV,YAAa,OACb,aAAc,MACd,gBAAiB,SACjB,aAAc,GAChB,CAAC,EAED,SAASC,EAAOC,EAAQ,CACtB,MAAMC,EAASD,EAAO,OACpB,CACEE,EACA,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAExEP,EACA;AAAA;AAAA,qBAEeE,mCAA+CD,WAAsBE;AAAA,gDAC1CC;AAAA,gDACAC;AAAA,mDACGC;AAAA,oDACCC;AAAA,eAEhD,EACJ,EAEElC,EAAQ,mBAAmB,YAAa0B,CAAM,EAE9CJ,EAAgB,QAAO,CACzB,CAEA,IAAIa,EAAQ,KAEZpC,EAAK,iBAAiB,SAAU,MAAMqC,GAAK,CACzCA,EAAE,eAAc,EAEZD,GAAS,MAAMjC,EAAY,oBAAoB,QAASiC,CAAK,EAEjE,MAAME,EAAatC,EAAK,cAAc,aAAa,EAAE,MAErDC,EAAQ,UAAY,GAEpB,MAAMsC,EAAaxB,EAAcuB,CAAU,EAE3C,IAAIE,EAAc,GAElBJ,EAAQ,SAAY,CAClBhC,IACA,MAAMgB,EAAO,MAAMmB,IACnBd,EAAOL,CAAI,EACXf,IAEKmC,GACH/B,IAGF+B,EAAc,EAClB,EAEE,MAAMJ,EAAK,EAEXjC,EAAY,iBAAiB,QAASiC,CAAK,CAC7C,CAAC"}